{% extends 'templates/shop_base.html' %}
{% block centent %}
<section class="shop-checkout container">
    <h2 class="page-title">Cart</h2>
    <div class="checkout-steps">
      <a href="/cart/" class="checkout-steps__item active">
        <span class="checkout-steps__item-number">01</span>
        <span class="checkout-steps__item-title">
          <span>Shopping Bag</span>
          <em>Manage Your Items List</em>
        </span>
      </a>
      <a href="/checkout/" class="checkout-steps__item">
        <span class="checkout-steps__item-number">02</span>
        <span class="checkout-steps__item-title">
          <span>Shipping and Checkout</span>
          <em>Checkout Your Items List</em>
        </span>
      </a>
    </div>
    <div class="shopping-cart">
      <div class="cart-table__wrapper">
        <table class="cart-table">
          <thead>
            <tr>
              <th>Product</th>
              <th></th>
              <th>Price</th>
              <th>Quantity</th>
              <th>Subtotal</th>
              <th></th>
            </tr>
          </thead>
          <tbody id="cartContainer">
            <tr>
              <td>
                <div class="shopping-cart__product-item">
                  <img loading="lazy" src="../images/cart-item-1.jpg" width="120" height="120" alt="">
                </div>
              </td>
              <td>
                <div class="shopping-cart__product-item__detail">
                  <h4>Zessi Dresses</h4>
                  <ul class="shopping-cart__product-item__options">
                    <li>Color: Yellow</li>
                    <li>Size: L</li>
                  </ul>
                </div>
              </td>
              <td>
                <span class="shopping-cart__product-price">$99</span>
              </td>
              <td>
                <div class="qty-control position-relative qty-initialized">
                  <input type="number" name="quantity" value="3" min="1" class="qty-control__number text-center">
                  <div class="qty-control__reduce">-</div>
                  <div class="qty-control__increase">+</div>
                </div><!-- .qty-control -->
              </td>
              <td>
                <span class="shopping-cart__subtotal">$297</span>
              </td>
              <td>
                <a href="#" class="remove-cart">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="#767676" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.259435 8.85506L9.11449 0L10 0.885506L1.14494 9.74056L0.259435 8.85506Z"></path>
                    <path d="M0.885506 0.0889838L9.74057 8.94404L8.85506 9.82955L0 0.97449L0.885506 0.0889838Z"></path>
                  </svg>                  
                </a>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="cart-table-footer">
          <form action="./" class="position-relative bg-body">
            <input class="form-control" type="text" name="coupon_code" placeholder="Coupon Code">
            <input class="btn-link fw-medium position-absolute top-0 end-0 h-100 px-4" type="submit" value="APPLY COUPON">
          </form>
          <button class="btn btn-light">UPDATE CART</button>
        </div>
      </div>
      <div class="shopping-cart__totals-wrapper">
        <div class="sticky-content">
          <div class="shopping-cart__totals">
            <h3>Cart Totals</h3>
            <table class="cart-totals">
              <tbody>
                <tr>
                  <th>Total</th>
                  <td id="totalItems">0 DA</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="mobile_fixed-btn_wrapper">
            <div class="button-wrapper container">
              <button class="btn btn-primary btn-checkout">PROCEED TO CHECKOUT</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <script>
    const fillGloablCartItem = () =>{
  /*
 ****** Fill the cart item with Locale storage ******
  */
    let parentCartItems = document.getElementById("cartContainer")
    const existingCartItems = JSON.parse(localStorage.getItem('cartItems'));
    let cartItemsCount = document.querySelectorAll('.cart_number');
    let subTotalCount = document.querySelectorAll('.sub-total-count');
    var htmlInnerContent = '';
    cartItemsCount.forEach(e=>{
      e.innerHTML =existingCartItems.length;

    })
existingCartItems.forEach(item => {
    htmlInnerContent +=`
    <tr>
              <td>
                <div class="shopping-cart__product-item">
                  <img loading="lazy" src="${item.image}" width="120" height="120" alt="">
                </div>
              </td>
              <td>
                <div class="shopping-cart__product-item__detail">
                  <h4>${item.name}</h4>
                  <ul class="shopping-cart__product-item__options">
                    <li>Color:  ${item.color}</li>
                    <li>Size:  ${item.size}</li>
                  </ul>
                </div>
              </td>
              <td>
                <span class="shopping-cart__product-price">${item.price} DA</span>
              </td>
              <td>
                <div class="qty-control position-relative qty-initialized">
                  <input type="number" name="quantity" value="${item.qty}" min="1" class="qty-control__number text-center">
                  <div class="qty-control__reduce">-</div>
                  <div class="qty-control__increase">+</div>
                </div>
                <!-- .qty-control -->
              </td>
              <td>
                <span class="shopping-cart__subtotal">${item.price*item.qty} DA</span>
              </td>
              <td>
                <a href="#" class="remove-cart" onclick="removeItemFromCart(this)">
                  <svg width="10" height="10" viewBox="0 0 10 10" fill="#767676" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.259435 8.85506L9.11449 0L10 0.885506L1.14494 9.74056L0.259435 8.85506Z"></path>
                    <path d="M0.885506 0.0889838L9.74057 8.94404L8.85506 9.82955L0 0.97449L0.885506 0.0889838Z"></path>
                  </svg>                  
                </a>
              </td>
            </tr>

    `
});
parentCartItems.innerHTML = htmlInnerContent

}

// initialize items
fillGloablCartItem();
// initialize total items
const totalItems = document.getElementById("totalItems")
totalItems.innerHTML = `${getTotalOfItems()} DA`
  </script>
{% endblock %}
